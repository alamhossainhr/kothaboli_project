<div class="main-content"
    style="max-width: 800px; margin: 0 auto; padding: 20px; font-family: 'Hind Siliguri', sans-serif;">
    <h2 style="text-align: center; color: #1c1c1e; font-weight: 700;">ржПржЬрзЗржирзНржЯ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи (Fraud Prevention)</h2>

    <form method="POST" enctype="multipart/form-data" class="glass-card"
        style="background: white; padding: 30px; border-radius: 30px; border: 1px solid #ddd; box-shadow: 0 10px 30px rgba(0,0,0,0.05);">
        {% csrf_token %}

        <h4 style="color: #ff2d55; border-bottom: 1px solid #eee; padding-bottom: 10px;">ЁЯПа ржарж┐ржХрж╛ржирж╛</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
            <div style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 13px; color: #8e8e93;">ржмрж░рзНрждржорж╛ржи ржарж┐ржХрж╛ржирж╛</label>
                <textarea name="present_address" placeholder="ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржарж┐ржХрж╛ржирж╛ рж▓рж┐ржЦрзБржи..." required
                    style="padding: 15px; border-radius: 12px; border: 1px solid #ddd; min-height: 80px;">{{ agent_prof.present_address|default:'' }}</textarea>
            </div>
            <div style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 13px; color: #8e8e93;">рж╕рзНржерж╛ржпрж╝рзА ржарж┐ржХрж╛ржирж╛</label>
                <textarea name="permanent_address" placeholder="ржЖржкржирж╛рж░ рж╕рзНржерж╛ржпрж╝рзА ржарж┐ржХрж╛ржирж╛ рж▓рж┐ржЦрзБржи..." required
                    style="padding: 15px; border-radius: 12px; border: 1px solid #ddd; min-height: 80px;">{{ agent_prof.permanent_address|default:'' }}</textarea>
            </div>

        </div>
        <div style="display: flex; flex-direction: column; gap: 5px;">
            <label style="font-size: 13px; color: #8e8e93;">ржЖржкржирж╛рж░ ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░ (Own Mobile)</label>
            <input type="text" name="phone_number" value="{{ agent_prof.phone_number|default:'' }}"
                placeholder="017XXXXXXXX" style="padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
        </div>

        <h4 style="color: #ff2d55; border-bottom: 1px solid #eee; padding-bottom: 10px;">ЁЯСе ржирж┐ржХржЯрж╛рждрзНржорзАржпрж╝рзЗрж░ рждржерзНржп</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
            <div style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 13px; color: #8e8e93;">ржирж╛ржо</label>
                <input type="text" name="relative_name" value="{{ agent_prof.relative_name|default:'' }}"
                    placeholder="ржирж┐ржХржЯрж╛рждрзНржорзАржпрж╝рзЗрж░ ржирж╛ржо" required
                    style="padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
            </div>
            <div style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 13px; color: #8e8e93;">ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░</label>
                <input type="text" name="relative_mobile" value="{{ agent_prof.relative_mobile|default:'' }}"
                    placeholder="ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░" required
                    style="padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
            </div>
        </div>

        <h4 style="color: #ff2d55; border-bottom: 1px solid #eee; padding-bottom: 10px;">ЁЯЫбя╕П ржиржорж┐ржирж┐ рждржерзНржп</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
            <div style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 13px; color: #8e8e93;">ржиржорж┐ржирж┐рж░ ржирж╛ржо</label>
                <input type="text" name="nominee_name" value="{{ agent_prof.nominee_name|default:'' }}"
                    placeholder="ржиржорж┐ржирж┐рж░ ржирж╛ржо" required
                    style="padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
            </div>
            <div style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 13px; color: #8e8e93;">ржиржорж┐ржирж┐рж░ ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░</label>
                <input type="text" name="nominee_mobile" value="{{ agent_prof.nominee_mobile|default:'' }}"
                    placeholder="ржиржорж┐ржирж┐рж░ ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░" required
                    style="padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
            </div>
            <div style="display: flex; flex-direction: column; gap: 5px; grid-column: span 2;">
                <label style="font-size: 13px; color: #8e8e93;">ржиржорж┐ржирж┐рж░ NID ржиржорзНржмрж░</label>
                <input type="text" name="nominee_nid" value="{{ agent_prof.nominee_nid|default:'' }}"
                    placeholder="ржиржорж┐ржирж┐рж░ NID ржиржорзНржмрж░" required
                    style="padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
            </div>
        </div>
        <h4 style="color: #ff2d55; border-bottom: 1px solid #eee; padding-bottom: 10px;">ЁЯТ░ рж╕рж╛рж░рзНржнрж┐рж╕ ржЪрж╛рж░рзНржЬ</h4>
        <div style="margin-bottom: 25px;">
            <div style="display: flex; flex-direction: column; gap: 5px; max-width: 300px;">
                <label style="font-size: 13px; color: #8e8e93;">ржкрзНрж░рждрж┐ ржорж┐ржирж┐ржЯрзЗрж░ рж░рзЗржЯ (Minute Rate in рз│)</label>
                <div style="position: relative; display: flex; align-items: center;">
                    <span style="position: absolute; left: 15px; font-weight: 700; color: #1c1c1e;">рз│</span>
                    <input type="number" name="hourly_rate" value="{{ agent_prof.hourly_rate|default:'500' }}"
                        placeholder="0.00" step="0.01" required
                        style="padding: 12px 12px 12px 35px; width: 100%; border-radius: 10px; border: 1px solid #ddd; font-weight: 600;">
                </div>
                <p style="font-size: 11px; color: #8e8e93; margin-top: 4px;">* ржХрж╛рж╕рзНржЯржорж╛рж░ ржЖржкржирж╛рж░ ржПржЗ рж░рзЗржЯ ржЕржирзБржпрж╛рзЯрзА ржкрзЗржорзЗржирзНржЯ
                    ржХрж░ржмрзЗред</p>
            </div>
        </div>
        <div style="background: #f2f2f7; padding: 20px; border-radius: 20px; margin-bottom: 25px;">
            <label style="font-weight: 700; display: block; margin-bottom: 10px;">ржЬржирзНржо рждрж╛рж░рж┐ржЦ (Age Verification)</label>
            <input type="date" name="dob" value="{{ agent_prof.dob|date:'Y-m-d' }}" required
                style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #ddd;">
            <p style="font-size: 12px; color: #8e8e93; margin-top: 5px;">* ржПржиржЖржЗржбрж┐ ржЕржирзБржпрж╛рзЯрзА ржЬржирзНржо рждрж╛рж░рж┐ржЦ ржкрзНрж░ржжрж╛ржи ржХрж░рзБржиред</p>
        </div>

        <h4 style="color: #ff2d55; border-bottom: 1px solid #eee; padding-bottom: 10px;">ЁЯУД ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржбржХрзБржорзЗржирзНржЯрж╕</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">

            <div style="font-size: 13px; color: #48484a;">
                <label style="display: block; margin-bottom: 10px; font-weight: 600;">ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЫржмрж┐ (Max 5MB):</label>
                <input type="file" name="profile_image" id="profile_image" accept="image/png, image/jpeg"
                    style="display: block; width: 100%; padding: 8px; border: 1px dashed #ddd; border-radius: 10px;">
                <p style="font-size: 10px; color: #8e8e93; margin-top: 5px;">* рж╢рзБржзрзБржорж╛рждрзНрж░ JPG ржмрж╛ PNG ржлрж░ржорзНржпрж╛ржЯред</p>

                {% if agent_prof.profile_image %}
                <p style="color: #34c759; font-size: 11px; margin: 0;">тЬЕ ржЫржмрж┐ ржЖржкрж▓рзЛржб ржХрж░рж╛ ржЖржЫрзЗ</p>
                {% endif %}
            </div>

            <div style="font-size: 13px; color: #48484a;">
                <label style="display: block; margin-bottom: 10px; font-weight: 600;">ржПржиржЖржЗржбрж┐ (NID) ржХржкрж┐ (Max
                    5MB):</label>
                <input type="file" name="identity_document" id="identity_document"
                    accept="image/png, image/jpeg, application/pdf"
                    style="display: block; width: 100%; padding: 8px; border: 1px dashed #ddd; border-radius: 10px;">
                <p style="font-size: 10px; color: #8e8e93; margin-top: 5px;">* JPG, PNG ржмрж╛ PDF ржлрж░ржорзНржпрж╛ржЯред</p>

                {% if agent_prof.identity_document %}
                <div style="margin-top: 8px; padding: 10px; background: #f2f2f7; border-radius: 12px;">
                    <p style="color: #34c759; font-size: 11px; margin: 0 0 5px 0; font-weight: 700;">тЬЕ ржПржиржЖржЗржбрж┐ ржЖржкрж▓рзЛржб ржХрж░рж╛
                        ржЖржЫрзЗ</p>
                    <a href="{{ agent_prof.identity_document.url }}" target="_blank"
                        style="color: #007aff; text-decoration: none; font-size: 11px; font-weight: 600; display: inline-flex; align-items: center; gap: 4px;">
                        <i data-lucide="eye" style="width:12px; height:12px;"></i> ржмрж░рзНрждржорж╛ржи NID ржжрзЗржЦрзБржи
                    </a>
                    <p style="color: #8e8e93; font-size: 10px; margin-top: 5px;">* ржирждрзБржи ржлрж╛ржЗрж▓ рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рж▓рзЗ ржЖржЧрзЗрж░ржЯрж┐
                        ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯрзЗ ржпрж╛ржмрзЗред</p>
                </div>
                {% else %}
                <p style="color: #ff3b30; font-size: 11px; margin-top: 5px;">тЪая╕П ржХрзЛржирзЛ ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржб ржХрж░рж╛ рж╣рзЯржирж┐</p>
                {% endif %}
            </div>
        </div>

        <form method="POST" enctype="multipart/form-data" class="glass-card">
            {% csrf_token %}

            <button type="submit"
                style="width: 100%; background: #34c759; color: white; border: none; padding: 18px; border-radius: 15px; font-weight: 700; cursor: pointer;">
                рждржерзНржп ржЖржкржбрзЗржЯ ржХрж░рзБржи
            </button>
        </form>

        <div style="text-align: center; margin-top: 30px;">
            <a href="{% url 'agent_dashboard' %}" style="color: #007aff; text-decoration: none; font-weight: 600;">
                тЖР ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржбрзЗ ржлрж┐рж░рзЗ ржпрж╛ржи
            </a>
        </div>
    </form>
</div>

<script>
    document.querySelector('form').addEventListener('submit', function (e) {
        const profileImg = document.getElementById('profile_image');
        const nidDoc = document.getElementById('identity_document');

        const maxSize = 5 * 1024 * 1024; // 5MB limit
        const allowedImageTypes = ['image/jpeg', 'image/png', 'image/jpg'];
        const allowedDocTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];

        function validateFile(input, allowedTypes, label) {
            if (input.files.length > 0) {
                const file = input.files[0];

                if (file.size > maxSize) {
                    alert(`${label} рзл ржорзЗржЧрж╛ржмрж╛ржЗржЯрзЗрж░ (5MB) ржЪрзЗрзЯрзЗ ржмрзЬ рж╣рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ред`);
                    e.preventDefault();
                    return false;
                }

                if (!allowedTypes.includes(file.type)) {
                    alert(`${label} ржПрж░ ржлрж░ржорзНржпрж╛ржЯ рж╕ржарж┐ржХ ржирзЯред рж╢рзБржзрзБржорж╛рждрзНрж░ JPG, PNG ржмрж╛ PDF ржЖржкрж▓рзЛржб ржХрж░рзБржиред`);
                    e.preventDefault();
                    return false;
                }
            }
            return true;
        }

        if (!validateFile(profileImg, allowedImageTypes, "ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЫржмрж┐")) return;
        if (!validateFile(nidDoc, allowedDocTypes, "ржПржиржЖржЗржбрж┐ ржбржХрзБржорзЗржирзНржЯ")) return;
    });

    // Initialize Lucide icons
    lucide.createIcons();
</script>